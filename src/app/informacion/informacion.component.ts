import { Component, OnInit, OnDestroy } from '@angular/core';
import { CommonModule } from '@angular/common';

@Component({
  selector: 'app-informacion',
  standalone: true,
  imports: [CommonModule],
  templateUrl: './informacion.component.html',
  styleUrls: ['./informacion.component.css']
})
export class InformacionComponent implements OnInit, OnDestroy {
  
  // Datos de residuos existentes
  residuos = [
    { 
      nombre: 'Computadoras',
      imagen: 'assets/img/computadoras.jpg',
      caracteristicas: ['Computadoras de escritorio', 'Servidores', 'Estaciones de trabajo'],
      descripcion: 'De las computadoras como RAEE se extraen metales preciosos, pl치sticos, circuitos electr칩nicos, discos duros y otros componentes valiosos para reciclaje.'
    },
    { 
      nombre: 'Fotocopiadoras',
      imagen: 'assets/img/fotocopiadora.jpg',
      caracteristicas: ['Fotocopiadoras multifuncionales', 'Esc치neres especializados', 'Impresoras industriales'],
      descripcion: 'De las fotocopiadoras como RAEE se recuperan metales, pl치sticos, circuitos electr칩nicos y t칩neres, que requieren un reciclaje especializado.'
    },
    { 
      nombre: 'Celulares',
      imagen: 'assets/img/celular.jpg',
      caracteristicas: ['Smartphones', 'Celulares con teclado', 'Tel칠fonos b치sicos', 'Tablets m칩viles'],
      descripcion: 'De los celulares como RAEE se recuperan metales preciosos, bater칤as, pl치sticos y circuitos electr칩nicos para su reciclaje responsable.'
    },
    { 
      nombre: 'Impresoras',
      imagen: 'assets/img/impresora.jpg',
      caracteristicas: ['Impresoras l치ser', 'Impresoras de inyecci칩n', 'Equipos multifuncionales', 'Plotters'],
      descripcion: 'De las impresoras como RAEE se recuperan pl치sticos, metales, cartuchos de tinta y componentes electr칩nicos para su reutilizaci칩n o reciclaje.'
    },
    { 
      nombre: 'Pantallas',
      imagen: 'assets/img/pantallas.jpg',
      caracteristicas: ['Monitores LCD', 'Pantallas OLED', 'Televisores Plasma', 'Monitores CRT'],
      descripcion: 'De las pantallas como RAEE se extraen pl치sticos, vidrios, metales y componentes electr칩nicos, incluyendo sustancias como f칩sforo y mercurio en ciertos modelos.'
    },    
    { 
      nombre: 'M칩dems',
      imagen: 'assets/img/modem.jpg',
      caracteristicas: ['Routers wifi', 'Switches de red', 'Repetidores', 'Access points'],
      descripcion: 'Los m칩dems como RAEE contienen pl치sticos, placas de circuitos impresos, metales y componentes electr칩nicos que pueden ser recuperados para su reciclaje.'
    },
    { 
      nombre: 'Tabletas',
      imagen: 'assets/img/tabletas.jpg',
      caracteristicas: ['Tabletas Android', 'iPads', 'Kindle readers', 'Tabletas industriales'],
      descripcion: 'De las tabletas como RAEE se extraen metales preciosos, pl치sticos, bater칤as y circuitos electr칩nicos para su reciclaje y reutilizaci칩n.'
    },
    { 
      nombre: 'Cables',
      imagen: 'assets/img/cables.jpg',
      caracteristicas: ['Cables USB', 'Cables UTP', 'Cables Ethernet', 'Cables de alimentaci칩n'],
      descripcion: 'Los cables como RAEE incluyen materiales como cobre, pl치sticos y metales, que se recuperan y reciclan para su reutilizaci칩n.'
    },
    { 
      nombre: 'Port치tiles',
      imagen: 'assets/img/portatil.jpg',
      caracteristicas: ['Laptops empresariales', 'Ultrabooks', 'Netbooks', 'Estaciones m칩viles'],
      descripcion: 'Los port치tiles como RAEE contienen componentes electr칩nicos, metales y pl치sticos que se recuperan y reciclan para reducir el impacto ambiental.'
    },
    { 
      nombre: 'Perif칠ricos',
      imagen: 'assets/img/perifericos.jpg',
      caracteristicas: ['Mouses', 'Teclados', 'C치maras web', 'Parlantes', 'Auriculares', 'Micr칩fonos'],
      descripcion: 'Los perif칠ricos como RAEE incluyen componentes electr칩nicos y pl치sticos, que se extraen y reciclan para minimizar el impacto ambiental.'
    },
    { 
      nombre: 'Piezas y partes',
      imagen: 'assets/img/piezas.jpg',
      caracteristicas: ['Discos SSD', 'Memoria RAM', 'Placas madre', 'Tarjetas gr치ficas', 'Procesadores'],
      descripcion: 'Las piezas y partes de dispositivos electr칩nicos como RAEE incluyen metales preciosos, pl치sticos y materiales electr칩nicos que se extraen y reciclan.'
    },
  ];
  
  residuosSeleccionada: any = this.residuos[0];

  // Datos para el carrusel de aspectos
  carouselSlides = [
    {
      title: 'Aspectos Positivos',
      type: 'positive',
      content: [
        '17,4% de los RAEE documentados se gestionan adecuadamente a nivel mundial',
        'El n칰mero de pa칤ses con pol칤ticas sobre RAEE ha aumentado de 61 a 78 desde 2014',
        'Creciente conciencia ambiental y programas de reciclaje',
        'Desarrollo de tecnolog칤as m치s eficientes para el procesamiento',
        'Creaci칩n de empleos verdes en el sector del reciclaje'
      ],
      image: 'assets/img/gestion.jpg'
    },
    {
      title: 'Aspectos Negativos',
      type: 'negative',
      content: [
        'El destino del 82,6% de RAEE restante es incierto',
        'Los impactos ambientales var칤an seg칰n la regi칩n',
        'Los residuos electr칩nicos contienen aditivos t칩xicos y sustancias peligrosas',
        'Falta de infraestructura adecuada en pa칤ses en desarrollo',
        'Exportaci칩n ilegal de residuos a pa칤ses menos desarrollados'
      ],
      image: 'assets/img/incertidumbre.jpg'
    },
    {
      title: 'Soluciones Implementadas',
      type: 'solutions',
      content: [
        'Programas de Responsabilidad Extendida del Productor (REP)',
        'Centros de acopio especializados y certificados',
        'Tecnolog칤as avanzadas de separaci칩n y reciclaje',
        'Campa침as educativas y de sensibilizaci칩n',
        'Legislaci칩n espec칤fica para el manejo de RAEE'
      ],
      image: 'assets/img/61 a 78.png'
    }
  ];

  currentSlideIndex = 0;
  carouselInterval: any;

  // Datos para el carrusel de materiales
  materialDevices = [
    {
      name: 'Tel칠fono M칩vil',
      icon: '游님',
      image: 'assets/img/telefono_sin_fondo.png',
      materials: [
        { name: 'Pl치stico', percentage: '40%', color: '#f59e0b' },
        { name: 'Vidrio y Cer치mica', percentage: '20%', color: '#8b5cf6' },
        { name: 'Cobre', percentage: '10%', color: '#10b981' },
        { name: 'Acero', percentage: '10%', color: '#3b82f6' },
        { name: 'Aluminio', percentage: '3-20%', color: '#ef4444' },
        { name: 'Otros metales', percentage: '<5%', color: '#6b7280' }
      ]
    },
    {
      name: 'Televisor',
      icon: '游닠',
      image: 'assets/img/telev_personaje.png',
      materials: [
        { name: 'Hierro', percentage: '30%', color: '#374151' },
        { name: 'Pl치stico', percentage: '28%', color: '#f59e0b' },
        { name: 'Aluminio', percentage: '15%', color: '#ef4444' },
        { name: 'Cobre', percentage: '10%', color: '#10b981' },
        { name: 'Vidrio', percentage: '12%', color: '#8b5cf6' },
        { name: 'Otros', percentage: '5%', color: '#6b7280' }
      ]
    },
    {
      name: 'Computadora',
      icon: '游눹',
      image: 'assets/img/tele1.png',
      materials: [
        { name: 'Pl치stico', percentage: '23%', color: '#f59e0b' },
        { name: 'Cobre', percentage: '18%', color: '#10b981' },
        { name: 'Hierro', percentage: '7%', color: '#374151' },
        { name: 'Aluminio', percentage: '5%', color: '#ef4444' },
        { name: 'Vidrio', percentage: '15%', color: '#8b5cf6' },
        { name: 'Metales preciosos', percentage: '2%', color: '#6b7280' }
      ]
    }
  ];

  currentMaterialIndex = 0;
  materialInterval: any;

  ngOnInit(): void {
    this.initAOS();
    this.startCarousel();
    this.startMaterialCarousel();
  }

  ngOnDestroy(): void {
    if (this.carouselInterval) {
      clearInterval(this.carouselInterval);
    }
    if (this.materialInterval) {
      clearInterval(this.materialInterval);
    }
  }

  async initAOS(): Promise<void> {
    try {
      const AOS = await import('aos');
      AOS.init({
        duration: 1000,
        once: true,
        offset: 100,
        easing: 'ease-in-out',
        delay: 0,
        anchorPlacement: 'top-bottom'
      });
    } catch (error) {
      console.error('Error loading AOS:', error);
    }
  }

  // M칠todos para gesti칩n de residuos
  seleccionarResiduo(residuo: any): void {
    this.residuosSeleccionada = residuo;
    
    // Reinicializar AOS para las nuevas animaciones
    setTimeout(() => {
      this.refreshAOS();
    }, 100);
  }

  // M칠todos para carrusel de aspectos
  startCarousel(): void {
    this.carouselInterval = setInterval(() => {
      this.nextSlide();
    }, 8000); // Cambia cada 8 segundos
  }

  nextSlide(): void {
    this.currentSlideIndex = (this.currentSlideIndex + 1) % this.carouselSlides.length;
  }

  previousSlide(): void {
    this.currentSlideIndex = this.currentSlideIndex === 0 
      ? this.carouselSlides.length - 1 
      : this.currentSlideIndex - 1;
  }

  goToSlide(index: number): void {
    this.currentSlideIndex = index;
  }

  // M칠todos para carrusel de materiales
  startMaterialCarousel(): void {
    this.materialInterval = setInterval(() => {
      this.nextMaterial();
    }, 6000); // Cambia cada 6 segundos
  }

  nextMaterial(): void {
    this.currentMaterialIndex = (this.currentMaterialIndex + 1) % this.materialDevices.length;
  }

  previousMaterial(): void {
    this.currentMaterialIndex = this.currentMaterialIndex === 0 
      ? this.materialDevices.length - 1 
      : this.currentMaterialIndex - 1;
  }

  goToMaterial(index: number): void {
    this.currentMaterialIndex = index;
  }

  // M칠todo para refrescar AOS
  private async refreshAOS(): Promise<void> {
    try {
      const AOS = await import('aos');
      AOS.refresh();
    } catch (error) {
      console.error('Error refreshing AOS:', error);
    }
  }

  // M칠todo para detener carruseles cuando el usuario interact칰a
  pauseCarousels(): void {
    if (this.carouselInterval) {
      clearInterval(this.carouselInterval);
    }
    if (this.materialInterval) {
      clearInterval(this.materialInterval);
    }
    
    // Reiniciar despu칠s de 10 segundos de inactividad
    setTimeout(() => {
      this.startCarousel();
      this.startMaterialCarousel();
    }, 10000);
  }

  // M칠todos para manejar interacciones del usuario
  onSlideClick(): void {
    this.pauseCarousels();
  }

  onMaterialClick(): void {
    this.pauseCarousels();
  }

  // M칠todo para obtener el color del slide actual
  getCurrentSlideColor(): string {
    const slide = this.carouselSlides[this.currentSlideIndex];
    switch (slide.type) {
      case 'positive':
        return '#10b981';
      case 'negative':
        return '#dc2626';
      case 'solutions':
        return '#2563eb';
      default:
        return '#6b7280';
    }
  }

  // M칠todo para obtener estad칤sticas din치micas
  getGlobalStats() {
    return [
      {
        icon: 'fas fa-globe-americas',
        title: 'Generaci칩n Global',
        value: '54 millones',
        description: 'de toneladas de RAEE generadas anualmente',
        color: '#3b82f6'
      },
      {
        icon: 'fas fa-recycle',
        title: 'Reciclaje Actual',
        value: '17.4%',
        description: 'de RAEE gestionados adecuadamente',
        color: '#10b981'
      },
      {
        icon: 'fas fa-chart-line',
        title: 'Crecimiento',
        value: '5%',
        description: 'anual en la generaci칩n de residuos',
        color: '#f59e0b'
      },
      {
        icon: 'fas fa-flag',
        title: 'Ecuador',
        value: '8춿 lugar',
        description: 'en Am칠rica Latina por generaci칩n per c치pita',
        color: '#ef4444'
      }
    ];
  }
}